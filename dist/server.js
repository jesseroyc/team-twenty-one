!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=26)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("defaults")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("mongodb")},function(e,t){e.exports=require("graceful-fs")},function(e,t){e.exports=require("serialize-javascript")},function(e,t){e.exports=require("react-router-config")},function(e,t){e.exports=require("dotenv")},function(e,t,r){t.console=r(16),t.file=r(17),t.mail=r(19),t.papertrail=r(22)},function(e,t,r){var n=r(5),o=r(2);e.exports=function(e){return e=o(e,{level:"info",colorize:!0,prettyPrint:!0,timestamp:!1,handleExceptions:!0}),new n.transports.Console(e)}},function(e,t,r){var n=r(2),o=r(18),i=r(3),s=r(5);e.exports=function(e){e=n(e,{level:"info",name:a()+".log",directory:"logs",maxSize:10485760,maxFiles:10,colorize:!1,timestamp:!0,json:!1});var t=i.join(process.cwd(),e.directory);c(t);var r=i.join(t,e.name);return e.filename=r,new s.transports.File(e)};var a=function(){var e=i.dirname(process.argv[1]).split(i.sep);return e[e.length-1]},c=function(e){o.existsSync(e)||o.mkdirSync(e)}},function(e,t){e.exports=require("fs")},function(e,t,r){var n=r(2),o=r(20),i=r(21);e.exports=function(e){(e=n(e,{timestamp:!0,prettyPrint:!0})).subject&&(e.subject="["+o.hostname()+"] - "+e.subject);return new i.Mail(e)}},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("winston-mail")},function(e,t,r){var n=r(2);e.exports=function(e){return e=n(e,{level:"info",colorize:!0,prettyPrint:!0,timestamp:!1}),new(0,r(23).Papertrail)(e)}},function(e,t){e.exports=require("winston-papertrail")},function(e,t){e.exports=require("react-dom")},function(e,t){e.exports=require("isomorphic-fetch")},function(e,t,r){"use strict";r.r(t);var n=r(3),o=r.n(n),i=r(4),s=r.n(i),a=r(7),c=r.n(a),l=r(8),u=r.n(l),d=r(2),p=r(15),f=r(5);var m=function(e){if(!e)throw new Error("Winston logger must be initialized with options.");t=d(t,{silly:"magenta",verbose:"blue",debug:"cyan",info:"green",warn:"yellow",error:"red",critical:"red",fatal:"red"}),f.addColors(t),h(f);var t;var r=[];Object.keys(e).forEach(function(t){var n=e[t];if(n){if("object"!=typeof n&&(n={}),!p[t])throw new Error("Failed to find transport "+t);var o=p[t],i=o(n);i&&r.push(i)}});var n=new f.Logger({transports:r});return h(n),n}({console:!0});function h(e,t){t=d(t,{silly:0,verbose:1,debug:2,info:3,warn:4,error:5,critical:6,fatal:7}),e.setLevels(t)}f.stream({start:-1}).on("log",function(e){console.log(e)});var v=r(9),g=r.n(v),x=r(10);const b=r.n(x).a.MongoClient;class ${constructor(e,t,r,n){this.HOST=e,this.PORT=t,this.USER=r,this.PASS=n,this.recordId=$.incrementId(),this.record={}}static incrementId(){return this.latestId?this.latestId++:this.latestId=1}setRecord(e,t,r,n){this.record={_id:this.recordId,tim:Math.floor(Date.now()/1e3),tmp:e,moi:t,hum:r,pre:n}}insertReading(e,t,r){let n=this.HOST,o=this.PORT,i=this.USER,s=this.PASS,a=this.record;const c=`mongodb://${i}:${s}@${n}:${o}`;m.info(c),b.connect(c,{useNewUrlParser:!0},function(e,i){e?(m.info(`Failed server connection to ${n} on port ${o}`),console.error(e),i.close()):m.info(`Successful server connection to ${n} on port ${o}`),i.db(t).collection(r).insertOne(a,function(e,n){e?(n.send(`Failed 'insert' client request for ${r} in ${t}`),m.info(`Failed 'insert' client request for ${r} in ${t}`),console.error(e),i.close()):(n.send(`Successful 'insert' client request for ${r} in ${t}`),m.info(`Successful 'insert' client request for ${r} in ${t}`),m.info("Inserted Record:\n  {\n    _id: "+n.ops[0]._id+"\n    tim: "+n.ops[0].tim+"\n    tmp: "+n.ops[0].tmp+"\n    moi: "+n.ops[0].moi+"\n    hum: "+n.ops[0].hum+"\n    pre: "+n.ops[0].pre+"\n  }"))})})}getReadings(e,t){let r=this.HOST,n=this.PORT;const o=`mongodb://${this.USER}:${this.PASS}@${r}:${n}`;b.connect(o,{useNewUrlParser:!0},function(o,i){o?(m.info(`Failed server connection to ${r} on port ${n}`),console.error(o),i.close()):m.info(`Successful server connection to ${r} on port ${n}`),i.db(e).collection(t).find({}).toArray(function(r,n){if(r)m.info(`Failed 'find' client request for ${t} in ${e}`),console.error(r),i.close();else{let r=n.map(e=>parseFloat(e.tmp)).filter(e=>!Number.isNaN(e)),o=n.map(e=>parseFloat(e.moi)).filter(e=>!Number.isNaN(e)),i=n.map(e=>parseFloat(e.hum)).filter(e=>!Number.isNaN(e)),s=n.map(e=>parseFloat(e.pre)).filter(e=>!Number.isNaN(e));m.info(`Successful 'find' client request for ${t} in ${e}`+`\nTemperature Readings:\n [${r}]`+`\nMoisture Readings:\n [${o}]`+`\nHumidity Readings:\n [${i}]`+`\nPressure Readings:\n [${s}]`)}})})}}var _=r(11),w=r.n(_),y=r(12),S=r.n(y),E=r(0),R=r.n(E),q=(r(24),r(6)),O=r.n(q),P=r(1),T=r(13),j=(r(25),e=>fetch(`https://jsonplaceholder.typicode.com/${e}`).then(e=>e.json()).then(e=>e.filter((e,t)=>t<10)));var N=[{path:"/",exact:!0,component:e=>R.a.createElement("h1",null,"Hello ",e.name,"!")},{path:"/todos",component:class extends R.a.Component{constructor(e){super(e),e.staticContext&&e.staticContext.data?this.state={data:e.staticContext.data}:this.state={data:[]}}componentDidMount(){setTimeout(()=>{window.__ROUTE_DATA__?(this.setState({data:window.__ROUTE_DATA__}),delete window.__ROUTE_DATA__):j("todos").then(e=>{this.setState({data:e})})},0)}render(){const{data:e}=this.state;return R.a.createElement("ul",null,e.map(e=>R.a.createElement("li",{key:e.id},e.title)))}},loadData:()=>j("todos")},{component:({staticContext:e={}})=>(e.status=404,R.a.createElement("h1",null,"Oops 404, nothing here!"))}],F=e=>R.a.createElement("div",null,R.a.createElement(P.NavLink,{to:"/"},"Home"),R.a.createElement(P.NavLink,{to:"/todos"},"Todos"),R.a.createElement(P.Switch,null,Object(T.renderRoutes)(N)));var A=function(e,t){const r=N.find(t=>Object(P.matchPath)(e.url,t))||{};(r.loadData?r.loadData():Promise.resolve(null)).then(r=>{const n={data:r},i=o.a.resolve(__dirname,"./public/index.html");w.a.readFile(i,"utf8",(o,i)=>{if(o)return console.error("Error:",o),t.status(500).end();if(404===n.status){console.log("err"),t.status(404);const e=O.a.renderToString(R.a.createElement("div",{id:"root"},R.a.createElement("p",null,"404")));return console.log("err"),t.send(i.replace('<div id="root"></div>',e))}const s=O.a.renderToString(R.a.createElement("div",{id:"root"},R.a.createElement(P.StaticRouter,{location:e.url,context:n},R.a.createElement(F,null))));return console.log("\n"+s+"\n"),t.send(i.replace('<div id="root"></div>',s).replace("</body>",`<script>window.__ROUTE_DATA__=${S()(r)}<\/script></body>`))})})};r(14).config();const I=s()();I.use(g()("dev")),I.use(u()()),I.use(c()()),I.use(s.a.json()),I.use(s.a.urlencoded({extended:!1})),I.use(s.a.static(o.a.join(__dirname,"public"))),I.get("/record/:tmp/:moi/:hum/:pre",function(e,t,r){let n=new $("mongodb","27017","admin","4dmInP4ssw0rd");n.setRecord(e.params.tmp,e.params.moi,e.params.hum,e.params.pre),n.insertReading(t,"mydatabase","records")}),I.get("/record",function(e,t,r){new $("mongodb","27017","admin","4dmInP4ssw0rd").getReadings("mydatabase","records"),r()}),I.get("*",function(e,t){A(e,t)}),I.listen(process.env.SERVER_PORT,function(e,t,r){e&&(r.locals.message=e.message,r.locals.error="development"===t.app.get("env")?e:{},m.error(`${e.status||500} - ${e.message} - ${t.originalUrl} - ${t.method} - ${t.ip}`),r.status(e.status||500),r.render("error")),m.info("Listening on",process.env.SERVER_PORT)});t.default=I}]);